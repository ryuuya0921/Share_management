<h1>みんなの広場</h1>
<p>「みんなの広場」では、作品についての感想や意見を他のユーザーと共有できます。</p>
<p>あなたが感動した作品について語り合ったり、他のユーザー様の感想を読んで新しい作品と出会うことができます。</p>

<%= link_to '新しい投稿を作成する', new_plaza_post_path, class: 'btn' %>

<!-- ワード検索フォーム -->
<%= form_with(url: plaza_posts_path, method: :get, local: true) do %>
  <div>
    <label for="search_word">キーワード検索:</label>
    <%= text_field_tag :search_word, params[:search_word] %>
  </div>
  <%= submit_tag "検索", class: "btn btn-primary" %>
  <%= link_to 'クリア', plaza_posts_path, class: 'btn btn-secondary' if params[:search_word].present? %>
<% end %>

<ul>
  <% page_number = (params[:page] || 1).to_i %>
  <% @plaza_posts.each_with_index do |post, index| %>
    <li>
      <p><%= (page_number - 1) * 10 + index + 1 %> 投稿者: <%= post.user.name %></p>
      <h3><%= link_to post.title, plaza_post_path(post) %></h3>
      <%= l(post.created_at, format: :short) %>

      <% if post.user == current_user %>
        <%= link_to '編集', edit_plaza_post_path(post), class: 'btn btn-primary' %>
        <%= link_to '削除', plaza_post_path(post), method: :delete, data: { confirm: '本当に削除しますか？' }, class: 'btn btn-danger' %>
      <% end %>
    </li>
  <% end %>
</ul>

<%= paginate @plaza_posts %>
<p>現在の合計投稿件数: <%= @plaza_posts.total_count %> 件</p>
